services:
  - type: web
    name: vibecheck-web
    runtime: python
    plan: free
    branch: deploy_app
    autoDeploy: true
    healthCheckPath: "/"
    numInstances: 1
    buildCommand: |
      pip install poetry
      poetry install --no-dev
    startCommand: |
      poetry run gunicorn "scripts.app:app"
    envVars:
      - key: FLASK_PORT
        value: "8080"
      - key: OUTPUT_DIR
        value: "/data"
      - key: DB_PATH
        value: "/data/vibecheck.db"
      - key: IMAGE_DIR
        value: "/data/images/restaurant_images"
      - key: FAISS_PATH
        value: "/data/vibecheck_index.faiss"
      - key: META_PATH
        value: "/data/meta_ids.npy"
      - key: VIBE_MAP_CSV
        value: "/data/vibe_map.csv"
